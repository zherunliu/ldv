import"./base-CKizj23g.js";import{v as W,a as q,E as H,b as J}from"./el-table-column-DwaBarbR.js";import{E as Q}from"./el-tag-CaHoz25R.js";import{E as X,a as Y}from"./el-select-DAXg0Ark.js";import"./el-scrollbar-CvPrqDL0.js";import"./el-popper-DB-QFI-H.js";import{E as Z}from"./el-input-BN5ZdFSC.js";import{E as ee,a as te}from"./el-checkbox-CFD2fDOk.js";/* empty css                   */import{E as D}from"./el-card-BV1UOK6Q.js";import{E as le,a as oe}from"./el-col-ztdj8VxH.js";import{E as P}from"./el-button-jLyDYas5.js";import{u as ae}from"./use-table-B7pDAX2g.js";import{E as ne}from"./el-dialog-CHWu0qio.js";import"./el-overlay-3WHg2bpZ.js";/* empty css                          */import{E as re}from"./el-tree-DrdRziGa.js";import"./el-text-C-1P6k4s.js";import{aM as L,e as O,aE as se,r as _,aw as ue,ay as ie,k as $,p as l,m as r,K as e,U,ag as p,o as T,j as pe,W as me,a5 as de,ah as B}from"./index-DNL56yZ_.js";import{E as ce}from"./index-BAA35Jxw.js";import"./index-C9txI7Rn.js";import"./event-WhKTvZKo.js";import"./isArrayLikeObject-BBBJdXaW.js";import"./aria-D7O-RZyP.js";import"./omit-C75Zi3em.js";import"./debounce-ByNTt4bK.js";import"./strings-BaOq2j4H.js";import"./raf-CAaaaqKq.js";import"./use-form-common-props-D46TsG5o.js";import"./index-B0kbSMQm.js";import"./_baseFindIndex-D7XfJLKM.js";import"./vnode-BSFz-22H.js";import"./refs-D6FW0B1r.js";import"./index-BvIgyUJ_.js";import"./index-oEx0czVV.js";import"./index-CKLXXqVO.js";function j(m){return m.map(a=>{const d={label:a.name,url:a.url};return a.children&&(d.children=j(a.children)),d})}function fe(m){return L("/userAuth",{pageAuthority:m})}function _e(m,a,d){return L("/setAuth",{account:m,btnList:a,pageList:d})}const ge=O({__name:"AuthModal",props:{visible:{type:Boolean},checkedKeys:{},btnAuth:{},accountNo:{}},emits:["close","reload"],setup(m,{emit:a}){const d=m,{visible:A,checkedKeys:x,btnAuth:g,accountNo:z}=se(d),b=_([]);b.value=g.value.slice();const V=ue(),v=_(),{menu:S}=ie(V),C=j(S.value),y=()=>{v.value?.setCheckedKeys(x.value)},E=a,h=()=>{E("close")},k=async()=>{(await _e(z.value,v.value?.getCheckedKeys(!0),b.value)).code===200&&(ce.success("权限设置成功"),h(),E("reload"))};return(N,n)=>{const t=re,u=D,s=te,c=ee,w=P,f=ne;return T(),$(f,{title:"权限设置",width:"600","model-value":r(A),onOpen:y,onClose:h},{footer:l(()=>[U("div",null,[e(w,{onClick:h},{default:l(()=>[...n[3]||(n[3]=[p("取消",-1)])]),_:1}),e(w,{type:"primary",onClick:k},{default:l(()=>[...n[4]||(n[4]=[p("确认",-1)])]),_:1})])]),default:l(()=>[e(u,null,{header:l(()=>[...n[1]||(n[1]=[U("span",null,"页面权限",-1)])]),default:l(()=>[e(t,{ref_key:"treeRef",ref:v,style:{"max-width":"600px"},"show-checkbox":"",data:r(C),"node-key":"url"},null,8,["data"])]),_:1}),e(u,{class:"mt"},{header:l(()=>[...n[2]||(n[2]=[U("span",null,"按钮权限",-1)])]),default:l(()=>[e(c,{modelValue:b.value,"onUpdate:modelValue":n[0]||(n[0]=K=>b.value=K)},{default:l(()=>[e(s,{label:"全部",value:"all"}),e(s,{label:"添加",value:"add"}),e(s,{label:"编辑",value:"edit"}),e(s,{label:"删除",value:"delete"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model-value"])}}}),et=O({__name:"System",setup(m){const a=_({name:"",department:""}),{dataList:d,loading:A,total:x,pageInfo:g,handleSizeChange:z,handleCurrentChange:b,resetPagination:V,loadData:v}=ae("/permissionList",a,10),S=()=>{a.value={name:"",department:""},V()},C=n=>{let t=[];return n.forEach(u=>{u.children&&u.children.length>0?t=t.concat(C(u.children)):t.push(u.url)}),t},y=_(!1),E=_([]),h=_([]),k=_(""),N=async(n,t)=>{const s=(await fe(n)).data;E.value=s.btn,h.value=C(s.list),k.value=t,y.value=!0};return(n,t)=>{const u=Z,s=oe,c=Y,w=X,f=P,K=le,M=D,i=q,R=Q,I=H,F=J,G=W;return T(),pe(me,null,[e(M,null,{default:l(()=>[e(K,{gutter:20},{default:l(()=>[e(s,{span:6},{default:l(()=>[e(u,{modelValue:a.value.name,"onUpdate:modelValue":t[0]||(t[0]=o=>a.value.name=o),modelModifiers:{trim:!0},placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),e(s,{span:6},{default:l(()=>[e(w,{modelValue:a.value.department,"onUpdate:modelValue":t[1]||(t[1]=o=>a.value.department=o),placeholder:"请选择部门"},{default:l(()=>[e(c,{label:"全部",value:""}),e(c,{label:"总裁办",value:"1"}),e(c,{label:"运营部",value:"2"}),e(c,{label:"维修部",value:"3"}),e(c,{label:"市场部",value:"4"}),e(c,{label:"财务部",value:"5"})]),_:1},8,["modelValue"])]),_:1}),e(s,{span:6},{default:l(()=>[e(f,{type:"primary",onClick:r(v)},{default:l(()=>[...t[5]||(t[5]=[p("搜索",-1)])]),_:1},8,["onClick"]),e(f,{onClick:S},{default:l(()=>[...t[6]||(t[6]=[p("重置",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(M,{class:"mt"},{default:l(()=>[de((T(),$(I,{data:r(d)},{default:l(()=>[e(i,{align:"center",type:"index",label:"序号",width:"80"}),e(i,{align:"center",prop:"name",label:"姓名"}),e(i,{align:"center",prop:"account",label:"账户"}),e(i,{align:"center",prop:"phone",label:"手机号"}),e(i,{align:"center",width:"200",prop:"idNo",label:"身份证号"}),e(i,{align:"center",prop:"position",label:"职位"},{default:l(o=>[e(R,{type:"primary"},{default:l(()=>[p(B(o.row.position),1)]),_:2},1024)]),_:1}),e(i,{align:"center",prop:"department",label:"部门"}),e(i,{align:"center",prop:"pageAuthority",label:"页面权限"},{default:l(o=>[e(R,{type:"success"},{default:l(()=>[p(B(o.row.pageAuthority),1)]),_:2},1024)]),_:1}),e(i,{align:"center",prop:"btnAuthority",label:"按钮权限"},{default:l(o=>[e(R,{type:"info"},{default:l(()=>[p(B(o.row.btnAuthority),1)]),_:2},1024)]),_:1}),e(i,{label:"操作",align:"center",width:"200"},{default:l(o=>[e(f,{type:"primary",size:"small",onClick:be=>N(o.row.pageAuthority,o.row.account)},{default:l(()=>[...t[7]||(t[7]=[p("编辑",-1)])]),_:1},8,["onClick"]),e(f,{type:"warning",size:"small"},{default:l(()=>[...t[8]||(t[8]=[p("禁用",-1)])]),_:1}),e(f,{type:"danger",size:"small"},{default:l(()=>[...t[9]||(t[9]=[p("删除",-1)])]),_:1})]),_:1})]),_:1},8,["data"])),[[G,r(A)]]),e(F,{class:"mt fr mb","current-page":r(g).page,"onUpdate:currentPage":t[2]||(t[2]=o=>r(g).page=o),"page-size":r(g).pageSize,"onUpdate:pageSize":t[3]||(t[3]=o=>r(g).pageSize=o),"page-sizes":[5,10,15,20],total:r(x),background:"",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:r(z),onCurrentChange:r(b)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])]),_:1}),e(ge,{visible:y.value,checkedKeys:h.value,btnAuth:E.value,accountNo:k.value,onClose:t[4]||(t[4]=o=>y.value=!1),onReload:r(v)},null,8,["visible","checkedKeys","btnAuth","accountNo","onReload"])],64)}}});export{et as default};
