import{bq as de,bg as se,a8 as Q,ab as ae,a2 as Y,a3 as Pe,aB as ee,g as be,b3 as ze,a9 as Fe,af as Ce,I as re,_ as pe,e as Ne,u as W,y as _,l as De,a4 as ke,B as J,r as K,a0 as te,Z as je,J as L,a5 as ie,a6 as le,j as F,o as D,U as ce,K as ne,k as z,N as H,p as oe,q as qe,s as T,V as A,n as Re,W as Ke,au as Se,bj as He,E as Ue,w as x,br as Ye,S as xe,z as _e,an as Je,H as We,C as Ge,T as B,ah as Ze,i as Qe,d as X,R as Xe,f as ve,aS as Ve,t as et}from"./index-DNL56yZ_.js";import{E as tt}from"./index-oEx0czVV.js";import{a as nt}from"./el-checkbox-CFD2fDOk.js";import{E as ot}from"./el-text-C-1P6k4s.js";import{f as dt}from"./base-CKizj23g.js";const j="$treeNodeId",me=function(t,e){!e||e[j]||Object.defineProperty(e,j,{value:t.id,enumerable:!1,configurable:!1,writable:!1})},ge=(t,e)=>e?.[t||j],he=(t,e,n)=>{const d=t.value.currentNode;n();const o=t.value.currentNode;d!==o&&e("current-change",o?o.data:null,o)},ue=t=>{let e=!0,n=!0,d=!0;for(let o=0,s=t.length;o<s;o++){const a=t[o];(a.checked!==!0||a.indeterminate)&&(e=!1,a.disabled||(d=!1)),(a.checked!==!1||a.indeterminate)&&(n=!1)}return{all:e,none:n,allWithoutDisable:d,half:!e&&!n}},U=function(t){if(t.childNodes.length===0||t.loading)return;const{all:e,none:n,half:d}=ue(t.childNodes);e?(t.checked=!0,t.indeterminate=!1):d?(t.checked=!1,t.indeterminate=!0):n&&(t.checked=!1,t.indeterminate=!1);const o=t.parent;!o||o.level===0||t.store.checkStrictly||U(o)},V=function(t,e){const n=t.store.props,d=t.data||{},o=n[e];if(ee(o))return o(d,t);if(be(o))return d[o];if(Y(o)){const s=d[e];return Y(s)?"":s}},fe=function(t,e){t.forEach(n=>{n.canFocus=e,fe(n.childNodes,e)})};let st=0;class M{constructor(e){this.isLeafByUser=void 0,this.isLeaf=void 0,this.id=st++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const n in e)de(e,n)&&(this[n]=e[n]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){var e;const n=this.store;if(!n)throw new Error("[Node]store is required!");n.registerNode(this);const d=n.props;if(d&&typeof d.isLeaf<"u"){const a=V(this,"isLeaf");se(a)&&(this.isLeafByUser=a)}if(n.lazy!==!0&&this.data?(this.setData(this.data),n.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&n.lazy&&n.defaultExpandAll&&!this.isLeafByUser&&this.expand(),Q(this.data)||me(this,this.data),!this.data)return;const o=n.defaultExpandedKeys,s=n.key;s&&!ae(this.key)&&o&&o.includes(this.key)&&this.expand(null,n.autoExpandParent),s&&n.currentNodeKey!==void 0&&this.key===n.currentNodeKey&&(n.currentNode&&(n.currentNode.isCurrent=!1),n.currentNode=this,n.currentNode.isCurrent=!0),n.lazy&&n._initDefaultCheckedNode(this),this.updateLeafState(),(this.level===1||((e=this.parent)==null?void 0:e.expanded)===!0)&&(this.canFocus=!0)}setData(e){Q(e)||me(this,e),this.data=e,this.childNodes=[];let n;this.level===0&&Q(this.data)?n=this.data:n=V(this,"children")||[];for(let d=0,o=n.length;d<o;d++)this.insertChild({data:n[d]})}get label(){return V(this,"label")}get key(){const e=this.store.key;return this.data?this.data[e]:null}get disabled(){return V(this,"disabled")}get nextSibling(){const e=this.parent;if(e){const n=e.childNodes.indexOf(this);if(n>-1)return e.childNodes[n+1]}return null}get previousSibling(){const e=this.parent;if(e){const n=e.childNodes.indexOf(this);if(n>-1)return n>0?e.childNodes[n-1]:null}return null}contains(e,n=!0){return(this.childNodes||[]).some(d=>d===e||n&&d.contains(e))}remove(){const e=this.parent;e&&e.removeChild(this)}insertChild(e,n,d){if(!e)throw new Error("InsertChild error: child is required.");if(!(e instanceof M)){if(!d){const o=this.getChildren(!0);o?.includes(e.data)||(Y(n)||n<0?o?.push(e.data):o?.splice(n,0,e.data))}Object.assign(e,{parent:this,store:this.store}),e=Pe(new M(e)),e instanceof M&&e.initialize()}e.level=this.level+1,Y(n)||n<0?this.childNodes.push(e):this.childNodes.splice(n,0,e),this.updateLeafState()}insertBefore(e,n){let d;n&&(d=this.childNodes.indexOf(n)),this.insertChild(e,d)}insertAfter(e,n){let d;n&&(d=this.childNodes.indexOf(n),d!==-1&&(d+=1)),this.insertChild(e,d)}removeChild(e){const n=this.getChildren()||[],d=n.indexOf(e.data);d>-1&&n.splice(d,1);const o=this.childNodes.indexOf(e);o>-1&&(this.store&&this.store.deregisterNode(e),e.parent=null,this.childNodes.splice(o,1)),this.updateLeafState()}removeChildByData(e){const n=this.childNodes.find(d=>d.data===e);n&&this.removeChild(n)}expand(e,n){const d=()=>{if(n){let o=this.parent;for(;o&&o.level>0;)o.expanded=!0,o=o.parent}this.expanded=!0,e&&e(),fe(this.childNodes,!0)};this.shouldLoadData()?this.loadData(o=>{Q(o)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||U(this),d())}):d()}doCreateChildren(e,n={}){e.forEach(d=>{this.insertChild(Object.assign({data:d},n),void 0,!0)})}collapse(){this.expanded=!1,fe(this.childNodes,!1)}shouldLoadData(){return!!(this.store.lazy===!0&&this.store.load&&!this.loaded)}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const e=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!e||e.length===0;return}this.isLeaf=!1}setChecked(e,n,d,o){if(this.indeterminate=e==="half",this.checked=e===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:a,allWithoutDisable:l}=ue(this.childNodes);!this.isLeaf&&!a&&l&&(this.checked=!1,e=!1);const u=()=>{if(n){const f=this.childNodes;for(let p=0,g=f.length;p<g;p++){const N=f[p];o=o||e!==!1;const k=N.disabled?N.checked:o;N.setChecked(k,n,!0,o)}const{half:i,all:c}=ue(f);c||(this.checked=c,this.indeterminate=i)}};if(this.shouldLoadData()){this.loadData(()=>{u(),U(this)},{checked:e!==!1});return}else u()}const s=this.parent;!s||s.level===0||d||U(s)}getChildren(e=!1){if(this.level===0)return this.data;const n=this.data;if(!n)return null;const d=this.store.props;let o="children";return d&&(o=d.children||"children"),Y(n[o])&&(n[o]=null),e&&!n[o]&&(n[o]=[]),n[o]}updateChildren(){const e=this.getChildren()||[],n=this.childNodes.map(s=>s.data),d={},o=[];e.forEach((s,a)=>{const l=s[j];!!l&&n.some(f=>f?.[j]===l)?d[l]={index:a,data:s}:o.push({index:a,data:s})}),this.store.lazy||n.forEach(s=>{d[s?.[j]]||this.removeChildByData(s)}),o.forEach(({index:s,data:a})=>{this.insertChild({data:a},s)}),this.updateLeafState()}loadData(e,n={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(n).length)){this.loading=!0;const d=s=>{this.childNodes=[],this.doCreateChildren(s,n),this.loaded=!0,this.loading=!1,this.updateLeafState(),e&&e.call(this,s)},o=()=>{this.loading=!1};this.store.load(this,d,o)}else e&&e.call(this)}eachNode(e){const n=[this];for(;n.length;){const d=n.shift();n.unshift(...d.childNodes),e(d)}}reInitChecked(){this.store.checkStrictly||U(this)}}class at{constructor(e){this.lazy=!1,this.checkStrictly=!1,this.autoExpandParent=!1,this.defaultExpandAll=!1,this.checkDescendants=!1,this.currentNode=null,this.currentNodeKey=null;for(const n in e)de(e,n)&&(this[n]=e[n]);this.nodesMap={}}initialize(){if(this.root=new M({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const e=this.load;e(this.root,n=>{this.root.doCreateChildren(n),this._initDefaultCheckedNodes()},ze)}else this._initDefaultCheckedNodes()}filter(e){const n=this.filterNodeMethod,d=this.lazy,o=async function(s){const a=s.root?s.root.childNodes:s.childNodes;for(const[l,u]of a.entries())u.visible=!!n?.call(u,e,u.data,u),l%80===0&&l>0&&await re(),await o(u);if(!s.visible&&a.length){let l=!0;l=!a.some(u=>u.visible),s.root?s.root.visible=l===!1:s.visible=l===!1}e&&s.visible&&!s.isLeaf&&(!d||s.loaded)&&s.expand()};o(this)}setData(e){e!==this.root.data?(this.nodesMap={},this.root.setData(e),this._initDefaultCheckedNodes(),this.setCurrentNodeKey(this.currentNodeKey)):this.root.updateChildren()}getNode(e){if(e instanceof M)return e;const n=Fe(e)?ge(this.key,e):e;return this.nodesMap[n]||null}insertBefore(e,n){var d;const o=this.getNode(n);(d=o.parent)==null||d.insertBefore({data:e},o)}insertAfter(e,n){var d;const o=this.getNode(n);(d=o.parent)==null||d.insertAfter({data:e},o)}remove(e){const n=this.getNode(e);n&&n.parent&&(n===this.currentNode&&(this.currentNode=null),n.parent.removeChild(n))}append(e,n){const d=Ce(n)?this.root:this.getNode(n);d&&d.insertChild({data:e})}_initDefaultCheckedNodes(){const e=this.defaultCheckedKeys||[],n=this.nodesMap;e.forEach(d=>{const o=n[d];o&&o.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(e){const n=this.defaultCheckedKeys||[];!ae(e.key)&&n.includes(e.key)&&e.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(e){e!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=e,this._initDefaultCheckedNodes())}registerNode(e){const n=this.key;if(!(!e||!e.data))if(!n)this.nodesMap[e.id]=e;else{const d=e.key;ae(d)||(this.nodesMap[d]=e)}}deregisterNode(e){!this.key||!e||!e.data||(e.childNodes.forEach(d=>{this.deregisterNode(d)}),delete this.nodesMap[e.key])}getCheckedNodes(e=!1,n=!1){const d=[],o=function(s){(s.root?s.root.childNodes:s.childNodes).forEach(l=>{(l.checked||n&&l.indeterminate)&&(!e||e&&l.isLeaf)&&d.push(l.data),o(l)})};return o(this),d}getCheckedKeys(e=!1){return this.getCheckedNodes(e).map(n=>(n||{})[this.key])}getHalfCheckedNodes(){const e=[],n=function(d){(d.root?d.root.childNodes:d.childNodes).forEach(s=>{s.indeterminate&&e.push(s.data),n(s)})};return n(this),e}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(e=>(e||{})[this.key])}_getAllNodes(){const e=[],n=this.nodesMap;for(const d in n)de(n,d)&&e.push(n[d]);return e}updateChildren(e,n){const d=this.nodesMap[e];if(!d)return;const o=d.childNodes;for(let s=o.length-1;s>=0;s--){const a=o[s];this.remove(a.data)}for(let s=0,a=n.length;s<a;s++){const l=n[s];this.append(l,d.data)}}_setCheckedKeys(e,n=!1,d){const o=this._getAllNodes().sort((u,f)=>u.level-f.level),s=Object.create(null),a=Object.keys(d);o.forEach(u=>u.setChecked(!1,!1));const l=u=>{u.childNodes.forEach(f=>{var i;s[f.data[e]]=!0,(i=f.childNodes)!=null&&i.length&&l(f)})};for(let u=0,f=o.length;u<f;u++){const i=o[u],c=i.data[e].toString();if(!a.includes(c)){i.checked&&!s[c]&&i.setChecked(!1,!1);continue}if(i.childNodes.length&&l(i),i.isLeaf||this.checkStrictly){i.setChecked(!0,!1);continue}if(i.setChecked(!0,!0),n){i.setChecked(!1,!1);const g=function(N){N.childNodes.forEach(v=>{v.isLeaf||v.setChecked(!1,!1),g(v)})};g(i)}}}setCheckedNodes(e,n=!1){const d=this.key,o={};e.forEach(s=>{o[(s||{})[d]]=!0}),this._setCheckedKeys(d,n,o)}setCheckedKeys(e,n=!1){this.defaultCheckedKeys=e;const d=this.key,o={};e.forEach(s=>{o[s]=!0}),this._setCheckedKeys(d,n,o)}setDefaultExpandedKeys(e){e=e||[],this.defaultExpandedKeys=e,e.forEach(n=>{const d=this.getNode(n);d&&d.expand(null,this.autoExpandParent)})}setChecked(e,n,d){const o=this.getNode(e);o&&o.setChecked(!!n,d)}getCurrentNode(){return this.currentNode}setCurrentNode(e){const n=this.currentNode;n&&(n.isCurrent=!1),this.currentNode=e,this.currentNode.isCurrent=!0}setUserCurrentNode(e,n=!0){var d;const o=e[this.key],s=this.nodesMap[o];this.setCurrentNode(s),n&&this.currentNode&&this.currentNode.level>1&&((d=this.currentNode.parent)==null||d.expand(null,!0))}setCurrentNodeKey(e,n=!0){var d;if(this.currentNodeKey=e,Ce(e)){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const o=this.getNode(e);o&&(this.setCurrentNode(o),n&&this.currentNode&&this.currentNode.level>1&&((d=this.currentNode.parent)==null||d.expand(null,!0)))}}const ye="RootTree",we="NodeInstance",Ee="TreeNodeMap",rt=Ne({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(t){const e=W("tree"),n=_(we),d=_(ye);return()=>{const o=t.node,{data:s,store:a}=o;return t.renderContent?t.renderContent(ke,{_self:n,node:o,data:s,store:a}):De(d.ctx.slots,"default",{node:o,data:s},()=>[ke(ot,{tag:"span",truncated:!0,class:e.be("node","label")},()=>[o.label])])}}});var it=pe(rt,[["__file","tree-node-content.vue"]]);function Ie(t){const e=_(Ee,null),n={treeNodeExpand:d=>{var o;t.node!==d&&((o=t.node)==null||o.collapse())},children:[]};return e&&e.children.push(n),J(Ee,n),{broadcastExpanded:d=>{if(t.accordion)for(const o of n.children)o.treeNodeExpand(d)}}}const Te=Symbol("dragEvents");function lt({props:t,ctx:e,el$:n,dropIndicator$:d,store:o}){const s=W("tree"),a=K({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return J(Te,{treeNodeDragStart:({event:i,treeNode:c})=>{if(i.dataTransfer){if(ee(t.allowDrag)&&!t.allowDrag(c.node))return i.preventDefault(),!1;i.dataTransfer.effectAllowed="move";try{i.dataTransfer.setData("text/plain","")}catch{}a.value.draggingNode=c,e.emit("node-drag-start",c.node,i)}},treeNodeDragOver:({event:i,treeNode:c})=>{if(!i.dataTransfer)return;const p=c,g=a.value.dropNode;g&&g.node.id!==p.node.id&&te(g.$el,s.is("drop-inner"));const N=a.value.draggingNode;if(!N||!p)return;let k=!0,v=!0,m=!0,S=!0;ee(t.allowDrop)&&(k=t.allowDrop(N.node,p.node,"prev"),S=v=t.allowDrop(N.node,p.node,"inner"),m=t.allowDrop(N.node,p.node,"next")),i.dataTransfer.dropEffect=v||k||m?"move":"none",(k||v||m)&&g?.node.id!==p.node.id&&(g&&e.emit("node-drag-leave",N.node,g.node,i),e.emit("node-drag-enter",N.node,p.node,i)),k||v||m?a.value.dropNode=p:a.value.dropNode=null,p.node.nextSibling===N.node&&(m=!1),p.node.previousSibling===N.node&&(k=!1),p.node.contains(N.node,!1)&&(v=!1),(N.node===p.node||N.node.contains(p.node))&&(k=!1,v=!1,m=!1);const w=p.$el,O=w.querySelector(`.${s.be("node","content")}`).getBoundingClientRect(),$=n.value.getBoundingClientRect(),q=n.value.scrollTop;let E;const G=k?v?.25:m?.45:1:Number.NEGATIVE_INFINITY,h=m?v?.75:k?.55:0:Number.POSITIVE_INFINITY;let y=-9999;const b=i.clientY-O.top;b<O.height*G?E="before":b>O.height*h?E="after":v?E="inner":E="none";const I=w.querySelector(`.${s.be("node","expand-icon")}`).getBoundingClientRect(),Z=d.value;E==="before"?y=I.top-$.top+q:E==="after"&&(y=I.bottom-$.top+q),Z.style.top=`${y}px`,Z.style.left=`${I.right-$.left}px`,E==="inner"?je(w,s.is("drop-inner")):te(w,s.is("drop-inner")),a.value.showDropIndicator=E==="before"||E==="after",a.value.allowDrop=a.value.showDropIndicator||S,a.value.dropType=E,e.emit("node-drag-over",N.node,p.node,i)},treeNodeDragEnd:i=>{var c,p;const{draggingNode:g,dropType:N,dropNode:k}=a.value;if(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect="move"),g?.node.data&&k){const v={data:g.node.data};N!=="none"&&g.node.remove(),N==="before"?(c=k.node.parent)==null||c.insertBefore(v,k.node):N==="after"?(p=k.node.parent)==null||p.insertAfter(v,k.node):N==="inner"&&k.node.insertChild(v),N!=="none"&&(o.value.registerNode(v),o.value.key&&g.node.eachNode(m=>{var S;(S=o.value.nodesMap[m.data[o.value.key]])==null||S.setChecked(m.checked,!o.value.checkStrictly)})),te(k.$el,s.is("drop-inner")),e.emit("node-drag-end",g.node,k.node,N,i),N!=="none"&&e.emit("node-drop",g.node,k.node,N,i)}g&&!k&&e.emit("node-drag-end",g.node,null,N,i),a.value.showDropIndicator=!1,a.value.draggingNode=null,a.value.dropNode=null,a.value.allowDrop=!0}}),{dragState:a}}const ct=Ne({name:"ElTreeNode",components:{ElCollapseTransition:tt,ElCheckbox:nt,NodeContent:it,ElIcon:Ue,Loading:He},props:{node:{type:M,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:Boolean},emits:["node-expand"],setup(t,e){const n=W("tree"),{broadcastExpanded:d}=Ie(t),o=_(ye),s=K(!1),a=K(!1),l=K(),u=K(),f=K(),i=_(Te),c=xe();J(we,c),t.node.expanded&&(s.value=!0,a.value=!0);const p=o.props.props.children||"children";x(()=>{var h;const y=(h=t.node.data)==null?void 0:h[p];return y&&[...y]},()=>{t.node.updateChildren()}),x(()=>t.node.indeterminate,h=>{k(t.node.checked,h)}),x(()=>t.node.checked,h=>{k(h,t.node.indeterminate)}),x(()=>t.node.childNodes.length,()=>t.node.reInitChecked()),x(()=>t.node.expanded,h=>{re(()=>s.value=h),h&&(a.value=!0)});const g=h=>ge(o.props.nodeKey,h.data),N=h=>{const y=t.props.class;if(!y)return{};let b;if(ee(y)){const{data:I}=h;b=y(I,h)}else b=y;return be(b)?{[b]:!0}:b},k=(h,y)=>{(l.value!==h||u.value!==y)&&o.ctx.emit("check-change",t.node.data,h,y),l.value=h,u.value=y},v=h=>{he(o.store,o.ctx.emit,()=>{var y;if((y=o?.props)==null?void 0:y.nodeKey){const I=g(t.node);o.store.value.setCurrentNodeKey(I)}else o.store.value.setCurrentNode(t.node)}),o.currentNode.value=t.node,o.props.expandOnClickNode&&S(),(o.props.checkOnClickNode||t.node.isLeaf&&o.props.checkOnClickLeaf&&t.showCheckbox)&&!t.node.disabled&&w(!t.node.checked),o.ctx.emit("node-click",t.node.data,t.node,c,h)},m=h=>{var y;(y=o.instance.vnode.props)!=null&&y.onNodeContextmenu&&(h.stopPropagation(),h.preventDefault()),o.ctx.emit("node-contextmenu",h,t.node.data,t.node,c)},S=()=>{t.node.isLeaf||(s.value?(o.ctx.emit("node-collapse",t.node.data,t.node,c),t.node.collapse()):t.node.expand(()=>{e.emit("node-expand",t.node.data,t.node,c)}))},w=h=>{t.node.setChecked(h,!o?.props.checkStrictly),re(()=>{const y=o.store.value;o.ctx.emit("check",t.node.data,{checkedNodes:y.getCheckedNodes(),checkedKeys:y.getCheckedKeys(),halfCheckedNodes:y.getHalfCheckedNodes(),halfCheckedKeys:y.getHalfCheckedKeys()})})};return{ns:n,node$:f,tree:o,expanded:s,childNodeRendered:a,oldChecked:l,oldIndeterminate:u,getNodeKey:g,getNodeClass:N,handleSelectChange:k,handleClick:v,handleContextMenu:m,handleExpandIconClick:S,handleCheckChange:w,handleChildNodeExpand:(h,y,b)=>{d(y),o.ctx.emit("node-expand",h,y,b)},handleDragStart:h=>{o.props.draggable&&i.treeNodeDragStart({event:h,treeNode:t})},handleDragOver:h=>{h.preventDefault(),o.props.draggable&&i.treeNodeDragOver({event:h,treeNode:{$el:f.value,node:t.node}})},handleDrop:h=>{h.preventDefault()},handleDragEnd:h=>{o.props.draggable&&i.treeNodeDragEnd(h)},CaretRight:Ye}}});function ht(t,e,n,d,o,s){const a=L("el-icon"),l=L("el-checkbox"),u=L("loading"),f=L("node-content"),i=L("el-tree-node"),c=L("el-collapse-transition");return ie((D(),F("div",{ref:"node$",class:T([t.ns.b("node"),t.ns.is("expanded",t.expanded),t.ns.is("current",t.node.isCurrent),t.ns.is("hidden",!t.node.visible),t.ns.is("focusable",!t.node.disabled),t.ns.is("checked",!t.node.disabled&&t.node.checked),t.getNodeClass(t.node)]),role:"treeitem",tabindex:"-1","aria-expanded":t.expanded,"aria-disabled":t.node.disabled,"aria-checked":t.node.checked,draggable:t.tree.props.draggable,"data-key":t.getNodeKey(t.node),onClick:A(t.handleClick,["stop"]),onContextmenu:t.handleContextMenu,onDragstart:A(t.handleDragStart,["stop"]),onDragover:A(t.handleDragOver,["stop"]),onDragend:A(t.handleDragEnd,["stop"]),onDrop:A(t.handleDrop,["stop"])},[ce("div",{class:T(t.ns.be("node","content")),style:Re({paddingLeft:(t.node.level-1)*t.tree.props.indent+"px"})},[t.tree.props.icon||t.CaretRight?(D(),z(a,{key:0,class:T([t.ns.be("node","expand-icon"),t.ns.is("leaf",t.node.isLeaf),{expanded:!t.node.isLeaf&&t.expanded}]),onClick:A(t.handleExpandIconClick,["stop"])},{default:oe(()=>[(D(),z(qe(t.tree.props.icon||t.CaretRight)))]),_:1},8,["class","onClick"])):H("v-if",!0),t.showCheckbox?(D(),z(l,{key:1,"model-value":t.node.checked,indeterminate:t.node.indeterminate,disabled:!!t.node.disabled,onClick:A(()=>{},["stop"]),onChange:t.handleCheckChange},null,8,["model-value","indeterminate","disabled","onClick","onChange"])):H("v-if",!0),t.node.loading?(D(),z(a,{key:2,class:T([t.ns.be("node","loading-icon"),t.ns.is("loading")])},{default:oe(()=>[ne(u)]),_:1},8,["class"])):H("v-if",!0),ne(f,{node:t.node,"render-content":t.renderContent},null,8,["node","render-content"])],6),ne(c,null,{default:oe(()=>[!t.renderAfterExpand||t.childNodeRendered?ie((D(),F("div",{key:0,class:T(t.ns.be("node","children")),role:"group","aria-expanded":t.expanded,onClick:A(()=>{},["stop"])},[(D(!0),F(Ke,null,Se(t.node.childNodes,p=>(D(),z(i,{key:t.getNodeKey(p),"render-content":t.renderContent,"render-after-expand":t.renderAfterExpand,"show-checkbox":t.showCheckbox,node:p,accordion:t.accordion,props:t.props,onNodeExpand:t.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,["aria-expanded","onClick"])),[[le,t.expanded]]):H("v-if",!0)]),_:1})],42,["aria-expanded","aria-disabled","aria-checked","draggable","data-key","onClick","onContextmenu","onDragstart","onDragover","onDragend","onDrop"])),[[le,t.node.visible]])}var ut=pe(ct,[["render",ht],["__file","tree-node.vue"]]);function ft({el$:t},e){const n=W("tree");_e(()=>{s()}),Je(()=>{Array.from(t.value.querySelectorAll("input[type=checkbox]")).forEach(l=>{l.setAttribute("tabindex","-1")})});function d(a,l){var u,f;const i=e.value.getNode(a[l].dataset.key);return i.canFocus&&i.visible&&(((u=i.parent)==null?void 0:u.expanded)||((f=i.parent)==null?void 0:f.level)===0)}We(t,"keydown",a=>{const l=a.target;if(!l.className.includes(n.b("node")))return;const u=Ge(a),f=Array.from(t.value.querySelectorAll(`.${n.is("focusable")}[role=treeitem]`)),i=f.indexOf(l);let c;if([B.up,B.down].includes(u)){if(a.preventDefault(),u===B.up){c=i===-1?0:i!==0?i-1:f.length-1;const g=c;for(;!d(f,c);){if(c--,c===g){c=-1;break}c<0&&(c=f.length-1)}}else{c=i===-1?0:i<f.length-1?i+1:0;const g=c;for(;!d(f,c);){if(c++,c===g){c=-1;break}c>=f.length&&(c=0)}}c!==-1&&f[c].focus()}[B.left,B.right].includes(u)&&(a.preventDefault(),l.click());const p=l.querySelector('[type="checkbox"]');[B.enter,B.numpadEnter,B.space].includes(u)&&p&&(a.preventDefault(),p.click())});const s=()=>{var a;if(!t.value)return;const l=Array.from(t.value.querySelectorAll(`.${n.is("focusable")}[role=treeitem]`));Array.from(t.value.querySelectorAll("input[type=checkbox]")).forEach(i=>{i.setAttribute("tabindex","-1")});const f=t.value.querySelectorAll(`.${n.is("checked")}[role=treeitem]`);if(f.length){f[0].setAttribute("tabindex","0");return}(a=l[0])==null||a.setAttribute("tabindex","0")}}const pt={"check-change":(t,e,n)=>t&&se(e)&&se(n),"current-change":(t,e)=>!0,"node-click":(t,e,n,d)=>t&&e&&d instanceof Event,"node-contextmenu":(t,e,n,d)=>t instanceof Event&&e&&n,"node-collapse":(t,e,n)=>t&&e,"node-expand":(t,e,n)=>t&&e,check:(t,e)=>t&&e,"node-drag-start":(t,e)=>t&&e,"node-drag-end":(t,e,n,d)=>t&&d,"node-drop":(t,e,n,d)=>t&&e&&d,"node-drag-leave":(t,e,n)=>t&&e&&n,"node-drag-enter":(t,e,n)=>t&&e&&n,"node-drag-over":(t,e,n)=>t&&e&&n},Nt=Ne({name:"ElTree",components:{ElTreeNode:ut},props:{data:{type:X(Array),default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkOnClickLeaf:{type:Boolean,default:!0},checkDescendants:Boolean,autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:{type:X(Function)},showCheckbox:Boolean,draggable:Boolean,allowDrag:{type:X(Function)},allowDrop:{type:X(Function)},props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:Boolean,highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:Qe}},emits:pt,setup(t,e){const{t:n}=Xe(),d=W("tree"),o=K(new at({key:t.nodeKey,data:t.data,lazy:t.lazy,props:t.props,load:t.load,currentNodeKey:t.currentNodeKey,checkStrictly:t.checkStrictly,checkDescendants:t.checkDescendants,defaultCheckedKeys:t.defaultCheckedKeys,defaultExpandedKeys:t.defaultExpandedKeys,autoExpandParent:t.autoExpandParent,defaultExpandAll:t.defaultExpandAll,filterNodeMethod:t.filterNodeMethod}));o.value.initialize();const s=K(o.value.root),a=K(null),l=K(null),u=K(null),{broadcastExpanded:f}=Ie(t),{dragState:i}=lt({props:t,ctx:e,el$:l,dropIndicator$:u,store:o});ft({el$:l},o);const c=xe(),p=ve(()=>{let r=c?.parent;for(;r;){if(r.type.name==="ElTreeSelect")return!0;r=r.parent}return!1}),g=ve(()=>{const{childNodes:r}=s.value;return(!r||r.length===0||r.every(({visible:C})=>!C))&&!p.value});x(()=>t.currentNodeKey,r=>{o.value.setCurrentNodeKey(r??null)}),x(()=>t.defaultCheckedKeys,(r,C)=>{Ve(r,C)||o.value.setDefaultCheckedKey(r??[])}),x(()=>t.defaultExpandedKeys,r=>{o.value.setDefaultExpandedKeys(r??[])}),x(()=>t.data,r=>{o.value.setData(r)},{deep:!0}),x(()=>t.checkStrictly,r=>{o.value.checkStrictly=r});const N=r=>{if(!t.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");o.value.filter(r)},k=r=>ge(t.nodeKey,r.data),v=r=>{if(!t.nodeKey)throw new Error(`[Tree] nodeKey is required in ${r}`)},m=r=>{v("getNodePath");const C=o.value.getNode(r);if(!C)return[];const P=[C.data];let R=C.parent;for(;R&&R!==s.value;)P.push(R.data),R=R.parent;return P.reverse()},S=(r,C)=>o.value.getCheckedNodes(r,C),w=r=>o.value.getCheckedKeys(r),O=()=>{const r=o.value.getCurrentNode();return r?r.data:null},$=()=>{v("getCurrentKey");const r=O();return r?r[t.nodeKey]:null},q=(r,C)=>{v("setCheckedNodes"),o.value.setCheckedNodes(r,C)},E=(r,C)=>{v("setCheckedKeys"),o.value.setCheckedKeys(r,C)},G=(r,C,P)=>{o.value.setChecked(r,C,P)},h=()=>o.value.getHalfCheckedNodes(),y=()=>o.value.getHalfCheckedKeys(),b=(r,C=!0)=>{v("setCurrentNode"),he(o,e.emit,()=>{f(r),o.value.setUserCurrentNode(r,C)})},I=(r=null,C=!0)=>{v("setCurrentKey"),he(o,e.emit,()=>{f(),o.value.setCurrentNodeKey(r,C)})},Z=r=>o.value.getNode(r),Ae=r=>{o.value.remove(r)},Be=(r,C)=>{o.value.append(r,C)},Oe=(r,C)=>{o.value.insertBefore(r,C)},Le=(r,C)=>{o.value.insertAfter(r,C)},Me=(r,C,P)=>{f(C),e.emit("node-expand",r,C,P)},$e=(r,C)=>{v("updateKeyChild"),o.value.updateChildren(r,C)};return J(ye,{ctx:e,props:t,store:o,root:s,currentNode:a,instance:c}),J(dt,void 0),{ns:d,store:o,root:s,currentNode:a,dragState:i,el$:l,dropIndicator$:u,isEmpty:g,filter:N,getNodeKey:k,getNodePath:m,getCheckedNodes:S,getCheckedKeys:w,getCurrentNode:O,getCurrentKey:$,setCheckedNodes:q,setCheckedKeys:E,setChecked:G,getHalfCheckedNodes:h,getHalfCheckedKeys:y,setCurrentNode:b,setCurrentKey:I,t:n,getNode:Z,remove:Ae,append:Be,insertBefore:Oe,insertAfter:Le,handleNodeExpand:Me,updateKeyChildren:$e}}});function gt(t,e,n,d,o,s){const a=L("el-tree-node");return D(),F("div",{ref:"el$",class:T([t.ns.b(),t.ns.is("dragging",!!t.dragState.draggingNode),t.ns.is("drop-not-allow",!t.dragState.allowDrop),t.ns.is("drop-inner",t.dragState.dropType==="inner"),{[t.ns.m("highlight-current")]:t.highlightCurrent}]),role:"tree"},[(D(!0),F(Ke,null,Se(t.root.childNodes,l=>(D(),z(a,{key:t.getNodeKey(l),node:l,props:t.props,accordion:t.accordion,"render-after-expand":t.renderAfterExpand,"show-checkbox":t.showCheckbox,"render-content":t.renderContent,onNodeExpand:t.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),t.isEmpty?(D(),F("div",{key:0,class:T(t.ns.e("empty-block"))},[De(t.$slots,"empty",{},()=>{var l;return[ce("span",{class:T(t.ns.e("empty-text"))},Ze((l=t.emptyText)!=null?l:t.t("el.tree.emptyText")),3)]})],2)):H("v-if",!0),ie(ce("div",{ref:"dropIndicator$",class:T(t.ns.e("drop-indicator"))},null,2),[[le,t.dragState.showDropIndicator]])],2)}var yt=pe(Nt,[["render",gt],["__file","tree.vue"]]);const bt=et(yt);export{bt as E};
